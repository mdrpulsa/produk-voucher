<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Voucher Internet</title>
  <style>
    :root {
      --primary: #008ca7;
      --light: #f9f9f9;
      --white: #fff;
      --gray: #e0e0e0;
      --text: #333;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
      background: var(--light);
      color: var(--text);
    }

    h2 {
      text-align: center;
      color: var(--primary);
      margin-bottom: 20px;
    }

    .filter-wrapper {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }

    select {
      padding: 10px 12px;
      font-size: 15px;
      border: 1px solid var(--gray);
      border-radius: 8px;
      outline: none;
      min-width: 200px;
    }

    .table-container {
      width: 100%;
      overflow-x: auto;
      background: var(--white);
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed; /* Ensure the table fills the width */
    }

    th, td {
      padding: 14px 10px;
      text-align: center;
      border-bottom: 1px solid var(--gray);
      word-wrap: break-word; /* Allow long words to break into the next line */
    }

    th {
      background: var(--primary);
      color: var(--white);
    }

    td {
      font-size: 14px;
    }

    .btn {
      background: var(--primary);
      color: var(--white);
      padding: 6px 14px;
      border-radius: 6px;
      text-decoration: none;
      font-size: 13px;
      transition: background 0.2s;
    }

    .btn:hover {
      background: #00768e;
    }

    @media (max-width: 768px) {
      body {
        padding: 10px;
      }

      select {
        width: 100%;
      }
    }
  </style>
</head>
<body>

  <h2>Daftar Produk Voucher Internet</h2>

  <div class="filter-wrapper">
    <select id="operator" onchange="filterData(this.value)">
      <option value="Semua">Semua Operator</option>
      <option value="INDOSAT">INDOSAT</option>
      <option value="TRI">TRI</option>
      <option value="XL">XL</option>
      <option value="AXIS">AXIS</option>
      <option value="TELKOMSEL">TELKOMSEL</option>
      <option value="SMARTFREN">SMARTFREN</option>
      <option value="BYU">BYU</option>
    </select>
  </div>

  <div class="table-container" id="tabel">Memuat data...</div>

  <script>
    const url = "https://docs.google.com/spreadsheets/d/1h8G5S11u4Nr499ByzrKAChzKCPkLCiGS/gviz/tq?tqx=out:json&sheet=Sheet1";
    let semuaData = [];

    async function fetchData() {
      try {
        const response = await fetch(url);
        const text = await response.text();
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const rows = json.table.rows;

        semuaData = rows.map(row => {
          return {
            operator: row.c[1]?.v || "",
            namaProduk: row.c[2]?.v || "",
            paket: row.c[3]?.v || "",
            harga: row.c[4]?.v || "",
            link: row.c[5]?.v || "#"
          };
        });

        renderTable(semuaData);
      } catch (e) {
        document.getElementById("tabel").innerText = "Gagal memuat data.";
        console.error(e);
      }
    }

    function formatRupiah(angka) {
      if (!angka || isNaN(angka)) return "-";
      return "Rp " + Number(angka).toLocaleString("id-ID");
    }

    function renderTable(data) {
      let html = `<table>
        <thead>
          <tr>
            <th>Produk</th>
            <th>Paket</th>
            <th>Harga</th>
            <th>Order</th>
          </tr>
        </thead>
        <tbody>`;

      data.forEach(item => {
        html += `<tr>
          <td>${item.namaProduk}</td>
          <td>${item.paket}</td>
          <td>${formatRupiah(item.harga)}</td>
          <td><a class="btn" href="${item.link}" target="_blank">Order</a></td>
        </tr>`;
      });

      html += `</tbody></table>`;
      document.getElementById("tabel").innerHTML = html;
    }

    function filterData(operator) {
      if (operator === "Semua") {
        renderTable(semuaData);
      } else {
        const filtered = semuaData.filter(item => item.operator.toUpperCase() === operator.toUpperCase());
        renderTable(filtered);
      }
    }

    fetchData();
  </script>

</body>
</html>
